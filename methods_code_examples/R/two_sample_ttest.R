rm(list = ls())

# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------

N <- 60 
R_boot <- 1000 
set.seed(1)
x1 <- rnorm(N/2, mean = 0, sd = 1)
x2 <- rnorm(N/2, mean = 0.3, sd = 1) 

# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------

mean(x2) - mean(x1)
# [1] 0.3503164


# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------

out <- rep(NA, R_boot)
for (rr in 1 : R_boot){
  x1_rr <- sample(x1, replace = TRUE)
  x2_rr <- sample(x2, replace = TRUE)
  pval_rr <- t.test(x1_rr, x2_rr, paired = FALSE, var.equal = TRUE)$p.value
  out[rr] <- (pval_rr < 0.05)
}
mean(out)
# [1] 0.349


# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------


M <- 80
out <- rep(NA, R_boot)
for (rr in 1 : R_boot){
  x1_rr <- sample(x1, size = M/2, replace = TRUE)
  x2_rr <- sample(x2, size = M/2, replace = TRUE)
  pval_rr <- t.test(x1_rr, x2_rr, paired = FALSE, var.equal = TRUE)$p.value
  out[rr] <- (pval_rr < 0.05)
}
mean(out)
# [1] 0.44


# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------

M <- 80
# update sample to represent the target effect size
x1_upd <- x1
x2_upd <- x2 + (0.5 - (mean(x2) - mean(x1))) * 1
out <- rep(NA, R_boot)
for (rr in 1 : R_boot){
  x1_rr <- sample(x1_upd, size = 40, replace = TRUE)
  x2_rr <- sample(x2_upd, size = 40, replace = TRUE)
  pval_rr <- t.test(x1_rr, x2_rr, paired = FALSE, var.equal = TRUE)$p.value
  out[rr] <- (pval_rr < 0.05)
}
mean(out)
# [1] 0.752

